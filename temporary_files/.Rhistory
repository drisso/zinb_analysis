?estimate_zinb
library(scone)
?estimate_zinb
data(fluidigm)
library(scRNAseq)
data(fluidigm)
bio <- as.factor(fluidigm$Biological_Condition)
coverage <- as.factor(fluidigm$Coverage_Type)
clusters <- as.factor(fluidigm$Cluster2)
table(bio, clusters)
?estimate_zinb
pc <- prcomp(t(log1p(assay(fluidigm))), center=TRUE, scale=TRUE)
filter <- apply(assay(fluidigm), 1, function(x) length(x[x >= 5]) >= 5)
filter2 <- apply(assay(fluidigm, 2), 1, function(x) length(x[x >= 5]) >= 5)
fluidigm <- fluidigm[filter & filter2,]
pc <- prcomp(t(log1p(assay(fluidigm))), center=TRUE, scale=TRUE)
pc_fpkm <- prcomp(t(log1p(assay(fluidigm, 2))), center=TRUE, scale=TRUE)
deseq <- DESEQ_FN(assay(fluidigm))
pc_deseq <- prcomp(t(log1p(deseq)), center=TRUE, scale=TRUE)
w <- estimate_zinb(round(deseq))
names(pc_deseq)
head(pc_deseq$rotation)
head(pc_deseq$rotation[,1:3])
head(sort(pc_deseq$rotation[,1]))
head(sort(abs(pc_deseq$rotation[,1])))
head(sort(abs(pc_deseq$rotation[,1]), decreasing = TRUE))
genes_fpkm <- unique(sapply(1:3, function(i) names(sort(abs(pc_deseq$rotation[,1]), decreasing = TRUE))[1:100]))
genes_fpkm <- unique(sapply(1:3, function(i) names(sort(abs(pc_fpkm$rotation[,1]), decreasing = TRUE))[1:100]))
genes_fpkm
genes_fpkm <- unique(unlist(lapply(1:3, function(i) names(sort(abs(pc_fpkm$rotation[,1]), decreasing = TRUE))[1:100])))
genes_fpkm
genes_fpkm <- unique(unlist(lapply(1:3, function(i) names(sort(abs(pc_fpkm$rotation[,i]), decreasing = TRUE))[1:100])))
genes_fpkm
library(clusterCells)
dualHeatmap(heatData=t(assay(fluidigm, 2)), dual=FALSE, whVars = genes_fpkm)
dualHeatmap(heatData=t(assay(fluidigm, 2)), dual=FALSE, whVars = genes_fpkm, annCol = data.frame(Condition=bio, Cluster=clusters))
genes_deseq <- unique(unlist(lapply(1:3, function(i) names(sort(abs(pc_deseq$rotation[,i]), decreasing = TRUE))[1:100])))
dualHeatmap(heatData=t(deseq), dual=FALSE, whVars = genes_deseq, annCol = data.frame(Condition=bio, Cluster=clusters))
wpc2 <- bwpca(t(log1p(deseq)), t(matw))
library(scde)
wpc2 <- bwpca(t(log1p(deseq)), t(matw))
wpc2 <- bwpca(t(log1p(deseq))
)
names(wpc2)
dim(wpc2$rotation)
head(wpc2$rotation)
genes_fpkm <- unique(unlist(lapply(1:2, function(i) names(sort(abs(pc_fpkm$rotation[,i]), decreasing = TRUE))[1:100])))
dualHeatmap(heatData=t(assay(fluidigm, 2)), dual=FALSE, whVars = genes_fpkm, annCol = data.frame(Condition=bio, Cluster=clusters))
genes_deseq <- unique(unlist(lapply(1:2, function(i) names(sort(abs(pc_deseq$rotation[,i]), decreasing = TRUE))[1:100])))
dualHeatmap(heatData=t(deseq), dual=FALSE, whVars = genes_deseq, annCol = data.frame(Condition=bio, Cluster=clusters))
